Html/VirtualDom«import«Lang/Base¸ Lang/String¸ Control/Monad¸ Html/Document»¸ type«data«DomAttr¸ |«<attr>«String¸ String»¸ <event>«String¸ EventListener«Element»»»»¸ data«VNode¸ |«<vtext>«String»¸ <vnode>«String¸ [«DomAttr»¸ [«VNode»»»»»¸ define«_newElem«->>«String¸ Element»¸ ->>«name¸ Document:«.createElement«_document¸ name»»»»¸ setDomAttrs«->«Element¸ [«DomAttr»¸ Unit»¸ ->«element¸ attributes¸ @traverse«attributes¸ ->>«attr¸ i¸ match«attr¸ |«<attr>«name¸ value»¸ Element:«.setAttribute«element¸ name¸ value»»»¸ |«<event>«ev¸ listen»¸ Element:«.addEventListener«element¸ ev¸ listen»»»»»»»»»¸ template«vnodemac«"<"¸ 'tag¸ ">"¸ ->>«attr¸ "#>#"¸ "  "¸ children¸ <vnode>«'tag¸ attr¸ children»»»¸ vattrmac«": "¸ 'attr¸ ->>«" = "¸ val¸ <attr>«'attr¸ val»»»»¸ define«showVAttr«->«vattr¸ match«vattr¸ |«<attr>«name¸ val»¸ _concat«[«" "¸ name¸ "="""¸ val¸ """"»»»¸ |«<event>«name¸ val»¸ _concat«[«" "¸ name¸ "="""¸ .toString«val»¸ """"»»»»»»¸ showVNode«->«vnode¸ match«vnode¸ |«<vtext>«text»¸ text»¸ |«<vnode>«tag¸ attrs¸ children»¸ _concat«[«"<"¸ tag¸ @join«_map«attrs¸ showVAttr»¸ ""»¸ "/>"»»»»»»¸ <a«vnodemac«"a"»»¸ <br>«<vnode>«"br"¸ [¸ [»»¸ <b«vnodemac«"b"»»¸ <button«vnodemac«"button"»»¸ <canvas«vnodemac«"canvas"»»¸ <caption«vnodemac«"caption"»»¸ <cite«vnodemac«"cite"»»¸ <code«vnodemac«"code"»»¸ <em«vnodemac«"em"»»¸ <div«vnodemac«"div"»»¸ <dl«vnodemac«"dl"»»¸ <dt«vnodemac«"dt"»»¸ <dd«vnodemac«"dd"»»¸ <details«vnodemac«"details"»»¸ <input«vnodemac«"input"»»¸ <p«vnodemac«"p"»»¸ <span«vnodemac«"span"»»¸ :class«vattrmac«"class"»»¸ :id«vattrmac«"id"»»¸ :href«vattrmac«"href"»»¸ :onclick«vattrmac«"onclick"»»¸ :type«vattrmac«"type"»»¸ :text«<vtext>»»¸ instance«Show«DomAttr¸ _show«->>«a¸ showVAttr«a»»»»¸ Show«VNode¸ _show«->>«n¸ showVNode«n»»»»»¸ define«tust«_show«<span«[«:class«"primary"»¸ :id«"foo"»»¸ [«<span«[«:id«"bar"»»¸ [«:text«"Hello"»»»»»»»¸ vnodeToElem«->«vnode¸ match«vnode¸ |«<vtext>«txt»¸ _createTextNode«txt»»¸ |«_¸ ""»»»»»»